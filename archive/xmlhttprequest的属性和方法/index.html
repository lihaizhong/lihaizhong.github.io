<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/jpeg" href="/images/favicon.jpeg"><meta name="generator" content="Astro v5.12.0"><!-- Canonical URL --><link rel="canonical" href="https://lihaizhong.github.io/archive/xmlhttprequest%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95/"><!-- RSS Feed Discovery --><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><!-- Primary Meta Tags --><title>XMLHttpRequest的属性和方法</title><meta name="title" content="XMLHttpRequest的属性和方法"><meta name="description" content="Ajax技术的出现是为了解决发送服务器请求额外数据而不刷新整张页面的问题，从而实现更好的用户体验。把Ajax技术推到历史舞台上的关键技术是XMLHttpRequest对象。最早由微软发明，然后被其他浏览器所借鉴。
由于XMLHttpRequest对象本身非常难用，所以以往我们看到很多库实现了封装来帮助我们更好地使用它。为了了解更多XMLHttpRequest的细节，今天我们就来了解一下XMLHttpRequest的属性、方法和事件，帮助大家了解Ajax的底层能力。"><!-- Open Graph / Facebook --><!-- <meta property="og:type" content="website" />
<meta property="og:url" content={Astro.url} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={new URL(image, Astro.url)} /> --><!-- Twitter --><!-- <meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content={Astro.url} />
<meta property="twitter:title" content={title} />
<meta property="twitter:description" content={description} />
<meta property="twitter:image" content={new URL(image, Astro.url)} /> --><link rel="stylesheet" href="/astro_assets/asset.CTGH2W9s.css">
<style>article table{border-collapse:collapse;border:1px solid var(--heading-color)}article th,article td{padding:.5rem;border:1px solid var(--heading-color)}hr{border-top:1px solid var(--heading-color);margin:1rem 0}
</style></head> <body> <header class="box-border mt-9 mx-auto py-5 site-header" data-astro-cid-3ef6ksr2> <!-- <h2 class="mb-1 text-3xl font-bold">{SITE_TITLE}</h2> --> <nav class="mb-2" data-astro-cid-3ef6ksr2> <a href="/" class="text-xl inline-block no-underline" data-astro-cid-3ef6ksr2="true"> 首页 </a> <a href="/blog" class="text-xl inline-block no-underline" data-astro-cid-3ef6ksr2="true"> 博客 </a> <a href="/interview" class="text-xl inline-block no-underline" data-astro-cid-3ef6ksr2="true"> 面试题 </a> <a href="/archive" class="text-xl inline-block no-underline" data-astro-cid-3ef6ksr2="true"> 归档 </a> <a href="https://github.com/lihaizhong" class="text-xl inline-block no-underline" target="_blank" data-astro-cid-3ef6ksr2="true"> GitHub </a> </nav> <p class="my-3 text-base text-gray-400" data-astro-cid-3ef6ksr2>合抱之木生于毫末，九层之台起于累土，千里之行始于足下</p> </header>  <article>  <h1 class="text-3xl my-1">XMLHttpRequest的属性和方法</h1> <time datetime="2022-12-18T19:55:22.000Z"> Dec 19, 2022 </time>  <hr>  <h1>XMLHttpRequest的属性和方法</h1> <p>Ajax技术的出现是为了解决发送服务器请求额外数据而不刷新整张页面的问题，从而实现更好的用户体验。把Ajax技术推到历史舞台上的关键技术是XMLHttpRequest对象。最早由微软发明，然后被其他浏览器所借鉴。</p>
<p>在Ajax技术出现之前，这种浏览器与服务器的通信早在1998年就通过不同方式实现了。最初JavaScript对服务器的请求可以通过中介（如Java小程序或Flash影片）来发送。后来XHR对象提供了原生的浏览器通信能力，减少了实现这个目的的工作量。</p>
<p>由于XMLHttpRequest对象本身非常难用，所以以往我们看到很多库实现了封装来帮助我们更好地使用它。为了了解更多XMLHttpRequest的细节，今天我们就来了解一下XMLHttpRequest的属性、方法和事件，帮助大家了解Ajax的底层能力。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">declare</span><span style="color:#F97583"> var</span><span style="color:#E1E4E8"> XMLHttpRequest</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">    prototype</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    new</span><span style="color:#E1E4E8">()</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    readonly</span><span style="color:#FFAB70"> DONE</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> number</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    readonly</span><span style="color:#FFAB70"> HEADERS_RECEIVED</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> number</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    readonly</span><span style="color:#FFAB70"> LOADING</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> number</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    readonly</span><span style="color:#FFAB70"> OPENED</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> number</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">    readonly</span><span style="color:#FFAB70"> UNSENT</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> number</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="属性">属性</h2>
<ul>
<li><a href="#readystate%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">readyState</a></li>
<li><a href="#status%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">status</a></li>
<li><a href="#statustext%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">statusText</a></li>
<li><a href="#responsetype%E5%B1%9E%E6%80%A7">responseType</a></li>
<li><a href="#response%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">response</a></li>
<li><a href="#responsetext%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">responseText</a></li>
<li><a href="#responsexml%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">responseXML</a></li>
<li><a href="#responseurl%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">responseURL</a></li>
<li><a href="#timeout%E5%B1%9E%E6%80%A7">timeout</a></li>
<li><a href="#upload%E5%B1%9E%E6%80%A7%E5%8F%AA%E8%AF%BB">upload</a></li>
<li><a href="#withcredentials%E5%B1%9E%E6%80%A7">withCredentials</a></li>
</ul>
<h3 id="readystate属性只读">readyState属性（只读）</h3>
<p>该属性表示当前所处状态。</p>



































<table><thead><tr><th style="text-align:left">值</th><th style="text-align:left">状态</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left">0</td><td style="text-align:left">UNSENT</td><td style="text-align:left">未初始化状态，XMLHttpRequest已被创建，但尚未调用open方法</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">OPENED</td><td style="text-align:left">发送状态，open方法已被触发，在这个状态中，可以通过<code>setRequestHeader</code>方法来设置请求的头部，可以通过<code>send</code>方法来发起请求</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">HEADERS_RECEIVED</td><td style="text-align:left">发送状态，send方法已被触发，响应头也已经被接收</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">LOADING</td><td style="text-align:left">正在接收状态，响应体部分正在被接收</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">DONE</td><td style="text-align:left">接受完全状态，数据传输已经彻底完成或者失败</td></tr></tbody></table>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> xhr </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;UNSENT&#39;</span><span style="color:#E1E4E8">, xhr.readyState); </span><span style="color:#6A737D">// readyState 为 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">onprogress</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#E1E4E8">    console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;LOADING&#39;</span><span style="color:#E1E4E8">, xhr.readyState); </span><span style="color:#6A737D">// readyState 为 3</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">onload</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#E1E4E8">    console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;DONE&#39;</span><span style="color:#E1E4E8">, xhr.readyState); </span><span style="color:#6A737D">// readyState 为 4</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">open</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;GET&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;/api&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;OPENED&#39;</span><span style="color:#E1E4E8">, xhr.readyState); </span><span style="color:#6A737D">// readyState 为 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 在open方法和send方法之间执行setRequestHeader，以保证Header设置有效</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">setRequestHeader</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;x-token&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;test_token&#39;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span></code></pre>
<h3 id="status属性只读">status属性（只读）</h3>
<p>返回XMLHttpRequest请求中由服务器返回的数字状态码。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>在请求完成前，状态码始终为0。</li>
<li>如果XMLHttpRequest出错，浏览器返回的状态码也为0。</li>
<li>如果请求正常执行，状态码与<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status">标准的HTTP状态码</a>一致。</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="js"><code><span class="line"><span style="color:#6A737D">/**</span></span>
<span class="line"><span style="color:#6A737D"> * 输出如下：</span></span>
<span class="line"><span style="color:#6A737D"> *</span></span>
<span class="line"><span style="color:#6A737D"> * UNSENT（未发送）0</span></span>
<span class="line"><span style="color:#6A737D"> * OPENED（已打开）0</span></span>
<span class="line"><span style="color:#6A737D"> * LOADING（载入中）200</span></span>
<span class="line"><span style="color:#6A737D"> * DONE（完成）200</span></span>
<span class="line"><span style="color:#6A737D"> */</span></span>
<span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> xhr </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;UNSENT&#39;</span><span style="color:#E1E4E8">, xhr.status); </span><span style="color:#6A737D">// status 为 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">onprogress</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;LOADING&#39;</span><span style="color:#E1E4E8">, xhr.status); </span><span style="color:#6A737D">// status 为 200</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">onload</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;DONE&#39;</span><span style="color:#E1E4E8">, xhr.status); </span><span style="color:#6A737D">// status 为 200</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">open</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;GET&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;/server&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;OPENED&#39;</span><span style="color:#E1E4E8">, xhr.status); </span><span style="color:#6A737D">// status 为 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span></code></pre>
<h3 id="statustext属性只读">statusText属性（只读）</h3>
<p>返回XMLHttpRequest请求中由服务器返回的字符串状态信息，这则信息中也包含了响应的数字状态码。不同于使用一个数字来指示的状态码，这个属性包含了返回状态对应的文本信息，例如“OK”或者“Not Found”。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>如果请求的状态<code>readyState</code>的值为<code>UNSENT</code>或者<code>OPENED</code>，则这个属性的值将会是一个空字符串。</li>
<li>如果服务器未明确指定一个状态文本信息，则<code>statusText</code>的值将会被默认赋值为”OK”。</li>
</ol>
<h3 id="responsetype属性">responseType属性</h3>
<p>该属性是一个枚举字符串值，用于指定响应中包含的数据类型。它允许作者更改响应类型。</p>
<p>可能得值：</p>
<ul>
<li>&quot;&quot;：空的responseType字符串与默认类型”text”相同。</li>
<li>“arraybuffer”：response是一个包含二进制数据的<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer">JavaScript ArrayBuffer</a>。</li>
<li>“blob”：response是一个包含二进制数据的<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Blob">Blob</a>对象。</li>
<li>“document”：response是一个HTML <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document">Document</a>或XML <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLDocument">XMLDocument</a>，根据接收到的数据的MIME类型而定。</li>
<li>“json”：response是通过将接收到的数据内容解析为<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/JSON">JSON</a>而创建的JavaScript对象。</li>
<li>“text”：response是DOMString对象的文本。</li>
</ul>
<h3 id="response属性只读">response属性（只读）</h3>
<p>当请求体响应时，该属性会接收到请求体返回的数据。具体类型取决于responseType的值。</p>
<p>可能的响应类型有<code>ArrayBuffer</code>、<code>Blob</code>、<code>Document</code>、<code>DOMString</code>等</p>
<h3 id="responsetext属性只读">responseText属性（只读）</h3>
<p>当请求体响应时，该属性会接收到请求体返回的数据。</p>
<h3 id="responsexml属性只读">responseXML属性（只读）</h3>
<p>当请求体响应时，该属性返回一个包含请求检索的HTML或XML的Document。（根据<code>Content-Type</code>为<code>text/html</code>或者<code>application/xml</code>判断）</p>
<p><strong>注意</strong>：</p>
<ol>
<li>如果请求未成功，尚未发送，或者检索的数据无法解析为XML或者HTML，则为null。</li>
<li>如果服务器没有明确指出<code>Content-Type</code>头，可以使用<code>overrideMimeType</code>方法强制<code>XMLHttpRequest</code>解析为XML。</li>
</ol>
<h3 id="responseurl属性只读">responseURL属性（只读）</h3>
<p>当请求体响应时，返回序列化URL。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>如果URL为空，则返回空字符串。</li>
<li>如果URL有锚点，则位于<code>URL#</code>后面的内容会被删除。</li>
<li>如果URL有重定向，<code>responseURL</code>的值会是<strong>经过多次重定向后</strong>的最终URL。</li>
</ol>
<h3 id="timeout属性">timeout属性</h3>
<p>代表着一个请求在被自动终止前所消耗的毫秒数。默认为0，意味着没有超时。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>超时并不应该用在一个<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/document_environment">全局文档环境</a>中的<strong>同步</strong>XMLHttpRequest请求中，否则将会抛出一个<code>InvalidAccessError</code>类型的错误。</li>
<li>当超时发生时，timeout事件将被触发。</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> xhr </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">onload</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> () {</span></span>
<span class="line"><span style="color:#6A737D">  // 请求完成。在此进行处理。</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">ontimeout</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">e</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#6A737D">  // XMLHttpRequest 超时。在此做某事。</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">open</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;GET&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;/server&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.timeout </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 2000</span><span style="color:#E1E4E8">; </span><span style="color:#6A737D">// 超时时间，单位是毫秒</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span></code></pre>
<h3 id="upload属性只读">upload属性（只读）</h3>
<p>返回一个XMLHttpRequestUpload对象，用来表示上传的进度。这个对象时不透明的，但是作为一个<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequestEventTarget">XMLHttpRequestEventTarget</a>,可以通过对其绑定事件来追踪它的进度。</p>
<p>可以被绑定在upload对象上的事件监听器如下：</p>





































<table><thead><tr><th style="text-align:left">事件</th><th style="text-align:left">相应属性的信息类型</th></tr></thead><tbody><tr><td style="text-align:left">onloadstart</td><td style="text-align:left">获取开始</td></tr><tr><td style="text-align:left">onprogress</td><td style="text-align:left">数据传输进行中</td></tr><tr><td style="text-align:left">onabort</td><td style="text-align:left">获取操作终止</td></tr><tr><td style="text-align:left">onerror</td><td style="text-align:left">获取失败</td></tr><tr><td style="text-align:left">onload</td><td style="text-align:left">获取成功</td></tr><tr><td style="text-align:left">ontimeout</td><td style="text-align:left">获取操作在用户规定的时间内未完成</td></tr><tr><td style="text-align:left">onloadend</td><td style="text-align:left">获取完成（无论成功与否）</td></tr></tbody></table>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> XMLHttpRequestEventTarget</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> EventTarget</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">    onabort</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onerror</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onload</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onloadend</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onloadstart</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onprogress</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    ontimeout</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    addEventListener</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">K</span><span style="color:#F97583"> extends</span><span style="color:#F97583"> keyof</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#B392F0"> K</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">listener</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">K</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> AddEventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">listener</span><span style="color:#F97583">:</span><span style="color:#B392F0"> EventListenerOrEventListenerObject</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> AddEventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    removeEventListener</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">K</span><span style="color:#F97583"> extends</span><span style="color:#F97583"> keyof</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#B392F0"> K</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">listener</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">K</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> EventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">listener</span><span style="color:#F97583">:</span><span style="color:#B392F0"> EventListenerOrEventListenerObject</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> EventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> XMLHttpRequestUpload</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> XMLHttpRequestEventTarget</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#B392F0">    addEventListener</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">K</span><span style="color:#F97583"> extends</span><span style="color:#F97583"> keyof</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#B392F0"> K</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">listener</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestUpload</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">K</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> AddEventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">listener</span><span style="color:#F97583">:</span><span style="color:#B392F0"> EventListenerOrEventListenerObject</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> AddEventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    removeEventListener</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">K</span><span style="color:#F97583"> extends</span><span style="color:#F97583"> keyof</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#B392F0"> K</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">listener</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestUpload</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">K</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> EventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">listener</span><span style="color:#F97583">:</span><span style="color:#B392F0"> EventListenerOrEventListenerObject</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> EventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="withcredentials属性">withCredentials属性</h3>
<p>该属性是一个布尔类型，它指示了是否该使用类似Cookies、Authorization Headers（头部授权）或者TLS客户端证书这类资格证书来创建一个跨站点访问控制（cross-siteAccess-Control）请求。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>在同一站点下使用<code>withCredentials</code>属性是无效的。</li>
<li>这个指示会被用做响应中Cookies被忽视的标识。默认是false。</li>
<li>不同域下的XMLHttpRequest响应，无论其<code>Access-Control-</code> Header设置什么值，都无法为它自身站点设置Cookie值（除非<strong>请求之前</strong>将<code>withCredentials</code>设置为<code>true</code>）。</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> xhr </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">open</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;GET&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&#39;http://example.com/&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.withCredentials </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> true</span><span style="color:#E1E4E8">; </span><span style="color:#6A737D">// 在发出请求之前设置为 true</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">null</span><span style="color:#E1E4E8">);</span></span></code></pre>
<h2 id="方法">方法</h2>
<ul>
<li><a href="#open%E6%96%B9%E6%B3%95">open()</a></li>
<li><a href="#send%E6%96%B9%E6%B3%95">send()</a></li>
<li><a href="#getrequestheader%E6%96%B9%E6%B3%95">getRequestHeader()</a></li>
<li><a href="#setrequestheader%E6%96%B9%E6%B3%95">setRequestHeader()</a></li>
<li><a href="#getallresponseheaders%E6%96%B9%E6%B3%95">getResponseHeaders()</a></li>
<li><a href="#overridemimetype%E6%96%B9%E6%B3%95">overrideMimeType()</a></li>
<li><a href="#abort%E6%96%B9%E6%B3%95">abort()</a></li>
</ul>
<h3 id="open方法">open方法</h3>
<p>该方法接收三个参数：请求类型（GET、POST等）、请求的URL、是否异步。</p>
<p>需要注意的是，URL是相对于代码所在的页面的，当然你也可以使用绝对URL。另外，调用open方法并不会实际发送请求，只是为发送请求做好准备。</p>
<p><strong>注意</strong>：请求默认情况下只能访问同源URL（域名相同、端口相同、协议相同）。如果请求的URL于发送请求的页面在任何方面有所不同，则会抛出安全错误。</p>
<p><strong>注意</strong>：由于同步的请求会阻塞JavaScript执行，所以一般情况下，我们不建议使用同步请求的方式。</p>
<h3 id="send方法">send方法</h3>
<p>该方法接收一个参数：要发送的数据。如果不需要发送任何数据，则必须传null（因为该参数在某些浏览器中是必需的）。调用send方法后，请求就会发送到服务器。</p>
<h3 id="getrequestheader方法">getRequestHeader方法</h3>
<p>该方法接收一个参数：Header的名称。返回包含指定响应头文本的字符串。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>如果在返回的响应头中有多个一样的名称，那么返回的值就会是用逗号和空格将值分隔的字符串。该方法以UTF编码返回值。</li>
<li>搜索的报文名是不区分大小写的。</li>
<li>如果连接未完成（响应中不存在报文项或者被W3C限制），则返回null。</li>
</ol>
<h3 id="setrequestheader方法">setRequestHeader方法</h3>
<p>设置HTTP请求头部的方法。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>该方法必须在<code>open</code>方法和<code>send</code>方法之间调用。</li>
<li>如果多次对同一个请求头赋值，只会生成<strong>一个合并了多个值</strong>的请求头。</li>
<li>如果没有设置<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept">Accept</a>属性，那么这个请求头会被默认设置为<code>*/*</code>。</li>
<li>安全起见，有些请求头的值只能由UserAgent设置：<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Forbidden_header_name">禁止修改的标头</a>和<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Forbidden_response_header_name">禁止修改的响应标头</a>。</li>
<li>自定义的header属性进行<strong>跨域请求</strong>时，可能会遇到”not allowed by Access-Control-Allow-Headers in preflight response”，你可能需要再你的服务器设置”Access-Control-Allow-Headers”。</li>
</ol>
<h3 id="getallresponseheaders方法">getAllResponseHeaders方法</h3>
<p>返回所有的响应头，以<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/CRLF">CRLF</a>分割的字符串。如果没有收到任何响应，则返回<code>null</code>。</p>
<p><strong>注意</strong>：对于<a href="https://stackoverflow.com/questions/16958448/what-is-http-multipart-request">复合请求</a>，这个方法返回的当前请求的头部，而不是最初的请求头的头部。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> request </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// 为了兼容所有浏览器，该事件处理函数必须放在open方法执行之前</span></span>
<span class="line"><span style="color:#E1E4E8">request.</span><span style="color:#B392F0">onreadystatechange</span><span style="color:#F97583"> =</span><span style="color:#F97583"> function</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#F97583">  if</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">this</span><span style="color:#E1E4E8">.readyState </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">HEADERS_RECEIVED</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    // Get the raw header string</span></span>
<span class="line"><span style="color:#F97583">    var</span><span style="color:#E1E4E8"> headers </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> request.</span><span style="color:#B392F0">getAllResponseHeaders</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    // Convert the header string into an array</span></span>
<span class="line"><span style="color:#6A737D">    // of individual headers</span></span>
<span class="line"><span style="color:#F97583">    var</span><span style="color:#E1E4E8"> arr </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> headers.</span><span style="color:#B392F0">trim</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">split</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">/</span><span style="color:#79B8FF">[\r\n]</span><span style="color:#F97583">+</span><span style="color:#9ECBFF">/</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    // Create a map of header names to values</span></span>
<span class="line"><span style="color:#F97583">    var</span><span style="color:#E1E4E8"> headerMap </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {};</span></span>
<span class="line"><span style="color:#E1E4E8">    arr.</span><span style="color:#B392F0">forEach</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">line</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">      var</span><span style="color:#E1E4E8"> parts </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> line.</span><span style="color:#B392F0">split</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;: &#39;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">      var</span><span style="color:#E1E4E8"> header </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> parts.</span><span style="color:#B392F0">shift</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#F97583">      var</span><span style="color:#E1E4E8"> value </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> parts.</span><span style="color:#B392F0">join</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;: &#39;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">      headerMap[header] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> value;</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"><span style="color:#E1E4E8">request.</span><span style="color:#B392F0">open</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;GET&quot;</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">&quot;foo.txt&quot;</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">request.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Headers For Example</span></span>
<span class="line"><span style="color:#6A737D">// date: Fri, 08 Dec 2017 21:04:30 GMT\r\n</span></span>
<span class="line"><span style="color:#6A737D">// content-encoding: gzip\r\n</span></span>
<span class="line"><span style="color:#6A737D">// x-content-type-options: nosniff\r\n</span></span>
<span class="line"><span style="color:#6A737D">// server: meinheld/0.6.1\r\n</span></span>
<span class="line"><span style="color:#6A737D">// x-frame-options: DENY\r\n</span></span>
<span class="line"><span style="color:#6A737D">// content-type: text/html; charset=utf-8\r\n</span></span>
<span class="line"><span style="color:#6A737D">// connection: keep-alive\r\n</span></span>
<span class="line"><span style="color:#6A737D">// strict-transport-security: max-age=63072000\r\n</span></span>
<span class="line"><span style="color:#6A737D">// vary: Cookie, Accept-Encoding\r\n</span></span>
<span class="line"><span style="color:#6A737D">// content-length: 6502\r\n</span></span>
<span class="line"><span style="color:#6A737D">// x-xss-protection: 1; mode=block\r\n</span></span></code></pre>
<h3 id="overridemimetype方法">overrideMimeType方法</h3>
<p>该方法是指一个MIME类型用户替代服务器指定的类型，使服务端响应信息中传输的数据按照指定MIME类型处理。</p>
<p><strong>注意</strong>：</p>
<ol>
<li>此方法必须在<strong>send方法之前</strong>调用方为有效。</li>
<li>如果服务器没有指定一个<code>Content-Type</code>头，MIME类型默认设置为<code>text/xml</code>。如果接受的数据不是有效的XML，将会出现“格式不正确”的错误。你能够通过调用<code>overrideMimeType</code>方法指定各种类型来避免这种情况。</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="js"><code><span class="line"><span style="color:#6A737D">// Interpret the received data as plain text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">req </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">req.</span><span style="color:#B392F0">overrideMimeType</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;text/plain&quot;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">req.</span><span style="color:#B392F0">addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;load&quot;</span><span style="color:#E1E4E8">, callback, </span><span style="color:#79B8FF">false</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">req.</span><span style="color:#B392F0">open</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;get&quot;</span><span style="color:#E1E4E8">, url);</span></span>
<span class="line"><span style="color:#E1E4E8">req.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">();</span></span></code></pre>
<h3 id="abort方法">abort方法</h3>
<p>如果请求已被发出，该方法可以终止请求。当一个请求被终止，它的readyState将被置为<code>XMLHttpRequest.UNSENT</code>（0），并且请求的<code>status</code>置为0。</p>
<p><strong>注意</strong>：如果请求已经达到服务器，服务器相关Controller方法并不会停止执行，只会造成执行结果无法返回，并且服务器会有报错提示。</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="js"><code><span class="line"><span style="color:#F97583">var</span><span style="color:#E1E4E8"> xhr </span><span style="color:#F97583">=</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">    method </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;GET&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">    url </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> &quot;https://developer.mozilla.org/&quot;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">open</span><span style="color:#E1E4E8">(method, url, </span><span style="color:#79B8FF">true</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">xhr.</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">OH_NOES_WE_NEED_TO_CANCEL_RIGHT_NOW_OR_ELSE</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#E1E4E8">  xhr.</span><span style="color:#B392F0">abort</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="事件">事件</h2>
<p><strong>事件响应顺序</strong>：loadstart -&gt; progress -&gt; (error/abort/load) -&gt; loadend</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;abort&quot;</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">&gt;;</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;error&quot;</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">&gt;;</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;load&quot;</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">&gt;;</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;loadend&quot;</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">&gt;;</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;loadstart&quot;</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">&gt;;</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;progress&quot;</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">&gt;;</span></span>
<span class="line"><span style="color:#9ECBFF">    &quot;timeout&quot;</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">&gt;;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> XMLHttpRequestEventTarget</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> EventTarget</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">    onabort</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onerror</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onload</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onloadend</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onloadstart</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    onprogress</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">    ontimeout</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> ((</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequest</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> ProgressEvent</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">|</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    addEventListener</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">K</span><span style="color:#F97583"> extends</span><span style="color:#F97583"> keyof</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#B392F0"> K</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">listener</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">K</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> AddEventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    addEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">listener</span><span style="color:#F97583">:</span><span style="color:#B392F0"> EventListenerOrEventListenerObject</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> AddEventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    removeEventListener</span><span style="color:#E1E4E8">&lt;</span><span style="color:#B392F0">K</span><span style="color:#F97583"> extends</span><span style="color:#F97583"> keyof</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">&gt;(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#B392F0"> K</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">listener</span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">this</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTarget</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">ev</span><span style="color:#F97583">:</span><span style="color:#B392F0"> XMLHttpRequestEventTargetEventMap</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">K</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=&gt;</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> EventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#B392F0">    removeEventListener</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">type</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">listener</span><span style="color:#F97583">:</span><span style="color:#B392F0"> EventListenerOrEventListenerObject</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">options</span><span style="color:#F97583">?:</span><span style="color:#79B8FF"> boolean</span><span style="color:#F97583"> |</span><span style="color:#B392F0"> EventListenerOptions</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>XMLHttpRequest支持<strong>DOM 0级事件处理机制</strong>和<strong>DOM 2级事件处理机制</strong>。</p>
<h3 id="dom-0级事件">DOM 0级事件</h3>
<ul>
<li>onloadstart</li>
<li>onload</li>
<li>onloadend</li>
<li>onprogress</li>
<li>onerror</li>
<li>onabort</li>
<li>ontimeout</li>
</ul>
<h3 id="dom-2级事件">DOM 2级事件</h3>
<ul>
<li>loadstart: 在接收到响应的第一个字节时触发</li>
<li>load: 在成功接收完成响应时触发</li>
<li>loadend: 在通信完成时，且在<code>error</code>、<code>abort</code>或者<code>load</code><strong>之后</strong>触发</li>
<li>progress: 在接收响应期间<strong>反复触发</strong></li>
<li>error: 在请求出错时触发</li>
<li>abort: 在调用<code>abort</code>方法终止连接时触发</li>
<li>timeout: 如果设置了<code>timeout</code>大于0ms，在响应超时时触发</li>
</ul>
<p><strong>注意</strong>：为保证兼容性，所有事件都应在<code>open</code>方法执行之前添加好。</p>
<h2 id="跨源资源共享">跨源资源共享</h2>
<p>通过XHR进行Ajax通信的一个<strong>主要限制</strong>是<strong>跨源安全策略</strong>。这个安全限制是为了防止某些恶意行为。而跨源资源共享（CORS）定义了浏览器与服务器之间如何实现跨源通信。</p>
<p>跨源资源共享的原理是通过HTTP头部信息，允许浏览器和服务器相互了解，以确实请求或响应应该成功还是失败。最基本的头部信息是<code>origin</code>字段。该字段包含发送请求的页面源（协议、域名和端口），以便服务器确定是否为其提供响应。</p>
<p>为了安全起见，跨域XHR对象施加了一些额外限制：</p>
<ol>
<li>不能使用<code>setRequestHeader</code>方法设置自定义头部。</li>
<li>不能发送和接收<code>Cookie</code>。</li>
<li><code>getAllResponseHeaders</code>方法始终返回空字符串。</li>
</ol>
<p>CORS通过一种叫<strong>预检请求</strong>的服务器验证机制。以下情况会触发预检机制：</p>
<ol>
<li>自定义头部</li>
<li>除GET和POST之外的方法</li>
<li>不同请求体内容类型</li>
</ol>
<p>预检请求使用<code>OPTIONS</code>方法，并包含以下头部：</p>
<ul>
<li>Origin：与简单请求相同。</li>
<li>Access-Control-Request-Method：请求希望使用的方法。</li>
<li>Access-Control-Request-Headers：（可选）要使用的自定义头部（逗号分隔的列表）。</li>
</ul>
<p>这个请求发送后，服务器可以确定是否允许这种类型的请求。在响应中，服务器会返回如下头部信息：</p>
<ul>
<li>Access-Control-Allow-Origin：与简单请求相同。</li>
<li>Access-Control-Allow-Methods： 允许的方法（逗号分隔的列表）。</li>
<li>Access-Control-Allow-Headers：服务器允许的头部（逗号分隔的列表）。</li>
<li>Access-Control-Max-Age：缓存预检请求的秒数。</li>
</ul>
<p>上面说到了CORS请求默认情况下会存在一些限制，可以通过将<code>withCredentials</code>属性设置为<code>true</code>来表明请求会发送凭据（Cookie、HTTP认证和客户端SSL证书）。如果服务器允许带凭据的请求，那么可以在响应中包含如下HTTP头部：</p>
<ul>
<li>Access-Control-Allow-Credentials: true</li>
</ul>
<p>如果发送了凭据请求而服务器返回的响应中没有这个头部，则浏览器不会把响应交给JavaScript（responseText为空，status是0，onerror被触发）。</p>
<h2 id="早期的跨域方案">早期的跨域方案</h2>
<p>在没有CORS之前，开发者需要利用DOM特性发送跨域请求。</p>
<ul>
<li>图片探测</li>
<li>JSONP</li>
</ul>
<h2 id="注意事项">注意事项</h2>
<ol>
<li>对于HTTP请求状态的判断，请使用status而不是statusText，因为后者已经被证明在跨浏览器的情况下不可靠。</li>
<li>无论是什么响应内容类型，responseText属性始终都会保存响应体，而responseXML属性不一定。</li>
<li>response属性会根据responseType来自动序列化数据。目前来看，兼容性不成问题，所以<strong>推荐使用</strong>。</li>
<li>为了保证跨浏览器兼容，<code>onreadystatechange</code>事件处理程序应该在<code>open</code>方法之前赋值。</li>
<li>为了保证请求头部被发送，<code>setRequestHeader</code>方法必须在<code>open</code><strong>方法之后</strong>、<code>send</code><strong>方法之前</strong>被调用。</li>
<li>POST请求相比GET请求要占用更多的资源。从性能方面说，发送相同数量的数据，GET请求比POST请求要快两倍。</li>
<li><code>Content-Type</code>如果是<code>application/x-www-formurlencoded</code>，使用<code>URLSearchParams</code>来创建数据；如果是<code>multipart/form-data</code>，使用<code>FormData</code>来创建数据。</li>
</ol>
<h2 id="参考">参考</h2>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest">【MDN】XMLHttpRequest</a></li>
<li>JavaScript高级程序设计</li>
</ul>  </article> <footer class="p-6 text-center"> <a class="no-underline text-inherit" href="javascript: void(0);">&copy; 2025 lihzsky.</a> All rights reserved.
</footer> </body></html>